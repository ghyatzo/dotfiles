#!/bin/bash

# --- Layout: defines the default behaviour for the new spaces (bsp or float)
#           Can be configured for a per-space basis
#               yabai -m config --space n layout float
yabai -m config layout bsp

# Where new windows spawn (default right/bottom split)
#       Left/Top
#yabai -m config window_placement first_child
#       Right/Bottom
yabai -m config window_placement second_child


# --- Padding Gaps and Splits

yabai -m config top_padding     0
yabai -m config bottom_padding  0
yabai -m config left_padding    0
yabai -m config right_padding   0
yabai -m config window_gap      0
# Per space basis
#   yabai -m config --space n window_gap 0

yabai -m config auto_balance off
yabai -m config split_ratio  0.5

# --- Mouse Support
yabai -m config mouse_modifier fn
yabai -m config mouse_action1 move
yabai -m config mouse_action2 resize

# autofocus: window get focused, but not raised
# autoraise: as if it was clicked on
# both disabled with modifier (to access menu items)
yabai -m config focus_follows_mouse autoraise

# mouse get moved to the center of the newly focused window
yabai -m config mouse_follows_focus off


# --- Windows Modifications
# floating windows are always on top
yabai -m config window_topmost on

# modify window shadows (options: on, off, float)
yabai -m config window_shadow float

# window opacity
# example: render all unfocused windows with 90% opacity
yabai -m config window_opacity off
yabai -m config window_opacity_duration 0
yabai -m config active_window_opacity 1.0
yabai -m config normal_window_opacity 1.0

# window border
#  - width has unit 1pt
#  - colors for borders are in the format AARRGGBB with hex values
#  - active means focused window, normal means unfocused window, insert means selected window
yabai -m config window_border off
yabai -m config window_border_radius 0
yabai -m config window_border_width 3
yabai -m config active_window_border_color  0xff775759
yabai -m config normal_window_border_color 0x00505050
yabai -m config insert_window_border_color  0xffd75f5f


# --- Statusbar
yabai -m config status_bar      on
yabai -m config status_bar_text_font "Helvetica Neue:Bold:12.0"
yabai -m config status_bar_icon_font "Font Awesome 5 Free:Solid:12.0"
yabai -m config status_bar_background_color 0xff282828
yabai -m config status_bar_foreground_color 0xffc8c4bd
yabai -m config status_bar_space_icon_strip  ⠂ ⠒ ⠓ ⠫ ⠯ ⡻ ⣽ ⣿
# yabai -m config status_bar_space_icon_strip  ⭕ ⭕ ⭕ ⭕ ⭕ ⭕ ⭕ ⭕ ⭕ ⭕ ⭕ ⭕ ⭕ ⭕ ⭕ ⭕
# yabai -m config status_bar_space_icon_strip  I:  II:  III:  IV:
yabai -m config status_bar_power_icon_strip "" ""
yabai -m config status_bar_space_icon   ""
yabai -m config status_bar_clock_icon   ""


# --- Signals
# Flashfocus emulation, on window focus quickly change the opacity
# yabai -m signal --add event=window_focused label="flashfocus" \
    # action='/Users/ghyatzo/.local/bin/flashfocus $YABAI_WINDOW_ID'

# --- Rules

yabai -m rule --add label="spotify-fullscreen" \
    app="^Spotify$" \
    native-fullscreen=on


# --- Rules --- Disable Manage/Fix opacity
yabai -m rule --add label="finder-copy" \
    app="^Finder$" \
    title="Copia" \
    manage=off
yabai -m rule --add label="finder-quick-look" \
    app="^Finder$" \
    title="^Info.*" \
    manage=off
yabai -m rule --add label="safari-opacity" \
    app="^Safari$" \
    opacity=1
yabai -m rule --add label="skim-opacity" \
    app="^Skim$" \
    opacity=1
yabai -m rule --add label="iina-float" \
    app="^IINA$" \
    manage=off \
    opacity=1
yabai -m rule --add label="system-preference-float" \
    app="^Preferenze\ di\ Sistema$" \
    manage=off \
    opacity=1

echo "yabai config loaded..."
